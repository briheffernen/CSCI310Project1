<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<project basedir="." default="compile" name="Project1">
    
    	<!--Global properties for this build file-->
	<property name="build.dir" location="bin" />
	<property name="doc.dir" location="doc" /> 
	<property name ="dist.dir" location="dist" />
	<property name ="source.dir" location = "src" />
	<property name = "lib.dir" location = "lib" /> 
	
	<!-- Set up directories used by this project -->
	<target name = "init" description = "setup project directories">
		<mkdir dir="${build.dir}"/> 
		<mkdir dir="${doc.dir}"/> 
		<mkdir dir="${dist.dir}"/> 
	</target>	
	
	<!-- Compile java code in src dir into build dir -->		
	<target name = "compile" depends = "init" description = "compile java sources">
		<javac srcdir="${source.dir}" destdir="${build.dir}"/> 
	</target>
	
	<!--  Delete the build and doc directories -->
	<target name = "clean" description = "tidy up">
		<delete dir = "${build.dir}"/> 
		<delete dir = "${doc.dir}" /> 
		<delete dir = "${dist.dir}" />
	</target>
	
	<!-- Transform bin class to dist jar -->
	<target name = "dist" depends = "init, compile" description = "make jar">
		<jar destfile = "${dist.dir}/Project1.jar" basedir = "${build.dir}/CSCI310"/>
	</target>
	
	<!-- Generate HTML files in doc dir -->
	<target name = "doc" depends = "init" description = "generate HTML"> 
		<javadoc sourcepath = "${source.dir}" destdir = "${doc.dir}" />
	</target>
    
    	<!-- Run Junit Tests -->
    	<property environment="env"/>
    <property name="junit.output.dir" value="junit"/>
    <path id="JUnit 5.libraryclasspath">
        <pathelement location="../../../.p2/pool/plugins/org.junit.jupiter.api_5.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.jupiter.engine_5.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.jupiter.migrationsupport_5.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.jupiter.params_5.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.platform.commons_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.platform.engine_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.platform.launcher_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.platform.runner_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.platform.suite.api_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit.vintage.engine_4.12.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.opentest4j_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.apiguardian_1.0.0.v20170910-2246.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.junit_4.12.0.v201504281640/junit.jar"/>
        <pathelement location="../../../.p2/pool/plugins/org.hamcrest.core_1.3.0.v201303031735.jar"/>
    </path>
    
    <path id="Project1.classpath">
        <pathelement location="bin"/>
        <path refid="JUnit 5.libraryclasspath"/>
    </path>
    	
    <target name = "test" depends = "init, compile" description = "run junit tests">
        <mkdir dir="${junit.output.dir}"/>
        <junit fork="yes" printsummary="withOutAndErr">
            <formatter type="xml"/>
            <test name="CSCI310.TestFlightMap" todir="${junit.output.dir}"/>
            <jvmarg line="-ea"/>
            <classpath refid="Project1.classpath"/>
        </junit>
            <junitreport todir="${junit.output.dir}">
            <fileset dir="${junit.output.dir}">
                <include name="TEST-*.xml"/>
            </fileset>
            <report format="frames" todir="${junit.output.dir}"/>
        </junitreport>
    </target>
</project>
